# =============================================================================
# APACHE KAFKA (Message Streaming)
# =============================================================================
# Start with: docker-compose up -d
# Stop with:  docker-compose down
# Port:       9092 (external), 9093 (internal)
#
# ⚠️  REQUIRES: Zookeeper (start zookeeper first!)
# =============================================================================

networks:
  bigdata-net:
    name: bigdata-net
    external: true

services:
  # ---------------------------------------------------------------------------
  # KAFKA
  # ---------------------------------------------------------------------------
  kafka:
    image: wurstmeister/kafka:2.12-2.4.1
    container_name: kafka
    restart: always
    ports:
      - "9092:9092"
    environment:
      # Listeners: Port 9093 for internal Docker traffic, 9092 for localhost access
      KAFKA_ADVERTISED_LISTENERS: INSIDE://kafka:9093,OUTSIDE://localhost:9092
      KAFKA_LISTENER_SECURITY_PROTOCOL_MAP: INSIDE:PLAINTEXT,OUTSIDE:PLAINTEXT
      KAFKA_LISTENERS: INSIDE://0.0.0.0:9093,OUTSIDE://0.0.0.0:9092
      KAFKA_INTER_BROKER_LISTENER_NAME: INSIDE
      KAFKA_ZOOKEEPER_CONNECT: zookeeper:2181
      KAFKA_CREATE_TOPICS: "test-topic:1:1"
    networks:
      - bigdata-net
